<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Smart Encryptor</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap');

        body {
            font-family: 'Share Tech Mono', monospace;
            background: radial-gradient(circle at bottom left, #141e30, #0d0d2b);
            color: white;
            text-align: center;
            margin: 0;
            padding: 0;
            overflow-x: hidden;
        }

        h1, h2 {
            font-size: 24px;
            color: white;
            text-shadow: 0 0 5px #ffffff, 0 0 10px #00c3ff;
        }

        .main-frame {
            border: 2px solid #00c3ff;
            border-radius: 15px;
            margin: 40px auto;
            padding: 50px 20px;
            max-width: 600px;
            background: linear-gradient(to bottom right, #000428, #004e92);
            box-shadow: 0 0 20px #00c3ff;
        }

        .futuristic-button {
            background: linear-gradient(to bottom, #101010, #2b2b2b);
            border: 2px solid #00c3ff;
            color: #00c3ff;
            font-size: 20px;
            padding: 15px 30px;
            border-radius: 50px;
            margin: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 0 10px #00c3ff;
        }

        .futuristic-button:hover {
            background: #00c3ff;
            color: #000;
            box-shadow: 0 0 20px #00c3ff, 0 0 40px #00c3ff;
        }

        .futuristic-button.small {
            padding: 8px 16px;
            font-size: 14px;
            margin: 5px 0;
        }

        input, textarea {
            display: block;
            margin: 10px auto;
            padding: 10px;
            width: 80%;
            border: none;
            border-radius: 5px;
            font-size: 16px;
        }

        img {
            max-width: 80%;
            margin: 20px auto;
            display: block;
            border-radius: 5px;
            border: 2px solid white;
        }

        .message {
            color: #00ff00;
            font-weight: bold;
        }

        .error {
            color: #ff4d4d;
            font-weight: bold;
        }

        .hidden {
            display: none;
        }

        .popup-message {
            position: fixed;
            top: 10%;
            left: 50%;
            transform: translateX(-50%);
            background: #00c3ff;
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            font-size: 16px;
            animation: fadeOut 2s ease-in-out;
        }

        .image-preview {
            margin: 20px 0;
            padding: 10px;
            border: 1px solid #444;
            border-radius: 5px;
        }

        .image-preview h3 {
            margin: 5px 0;
            font-size: 16px;
        }

        .note {
            font-size: 12px;
            color: #aaa;
            margin: 5px 0;
        }

        @keyframes fadeOut {
            0% { opacity: 1; }
            100% { opacity: 0; }
        }

        .green-text {
            color: #00ff00;
            font-weight: bold;
        }
    </style>
</head>
<body>

    <!-- HOME PAGE -->
    <h1>LOCK YOUR DATA WITH ENCRYPTION, UNLOCK IT WITH DECRYPTION—SEAMLESSLY AND SECURELY</h1>

    <div class="main-frame" id="home">
        <h2>DO YOU WANT TO:</h2>
        <button class="futuristic-button" onclick="showEncryptPage()">ENCRYPT DATA</button>
        <br>
        <button class="futuristic-button" onclick="showDecryptPage()">DECRYPT DATA</button>
    </div>

    <!-- ENCRYPT PAGE -->
    <div id="encryptPage" class="page hidden">
        <h2>Select Encryption Type:</h2>
        <button class="futuristic-button" onclick="showImageEncrypt()">Image Encryption</button>
        <button class="futuristic-button" onclick="showTextEncrypt()">Text Encryption</button>
        <br>
        <button class="futuristic-button" onclick="goHome()">🔙 Back</button>
    </div>

    <!-- DECRYPT PAGE -->
    <div id="decryptPage" class="page hidden">
        <h2>Select Decryption Type:</h2>
        <button class="futuristic-button" onclick="showImageDecrypt()">Image Decryption</button>
        <button class="futuristic-button" onclick="showTextDecrypt()">Text Decryption</button>
        <br>
        <button class="futuristic-button" onclick="goHome()">🔙 Back</button>
    </div>

    <!-- IMAGE ENCRYPT PAGE -->
    <div id="imageEncryptPage" class="page hidden">
        <h2>Image Encryption</h2>
        <input type="file" id="imageInput" accept="image/*">
        <button class="futuristic-button" onclick="encryptImage()">Encrypt</button>
        <div id="imagePasskey"></div>
        <br>
        <button class="futuristic-button" onclick="showEncryptPage()">🔙 Back</button>
    </div>

    <!-- TEXT ENCRYPT PAGE -->
    <div id="textEncryptPage" class="page hidden">
        <h2>Text Encryption</h2>
        <textarea id="textInput" rows="6" placeholder="Enter text to encrypt..."></textarea>
        <button class="futuristic-button" onclick="encryptText()">Encrypt</button>
        <div id="textPasskey"></div>
        <br>
        <button class="futuristic-button" onclick="showEncryptPage()">🔙 Back</button>
    </div>

    <!-- IMAGE DECRYPT PAGE -->
    <div id="imageDecryptPage" class="page hidden">
        <h2>Image Decryption</h2>
        <input type="text" id="imageKeyInput" placeholder="Enter image passkey...">
        <button class="futuristic-button" onclick="decryptImage()">Decrypt</button>
        <div id="imageError" class="error"></div>
        <img id="decryptedImage" class="hidden" />
        <br>
        <button class="futuristic-button" onclick="showDecryptPage()">🔙 Back</button>
    </div>

    <!-- TEXT DECRYPT PAGE -->
    <div id="textDecryptPage" class="page hidden">
        <h2>Text Decryption</h2>
        <input type="text" id="textKeyInput" placeholder="Enter text passkey...">
        <button class="futuristic-button" onclick="decryptText()">Decrypt</button>
        <div id="textError" class="error"></div>
        <div id="decryptedText" class="message"></div>
        <br>
        <button class="futuristic-button" onclick="showDecryptPage()">🔙 Back</button>
    </div>

    <script>
        // Navigation Functions
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => page.classList.add('hidden'));
            document.getElementById(pageId).classList.remove('hidden');
        }

        function goHome() {
            document.querySelectorAll('.page').forEach(page => page.classList.add('hidden'));
            document.getElementById('home').classList.remove('hidden');
            resetFields();
        }

        function showEncryptPage() { showPage('encryptPage'); resetFields(); }
        function showDecryptPage() { showPage('decryptPage'); resetFields(); }
        function showImageEncrypt() { showPage('imageEncryptPage'); resetFields(); }
        function showTextEncrypt() { showPage('textEncryptPage'); resetFields(); }
        function showImageDecrypt() { showPage('imageDecryptPage'); resetFields(); }
        function showTextDecrypt() { showPage('textDecryptPage'); resetFields(); }

        // Reset Fields
        function resetFields() {
            document.getElementById('imageInput').value = "";
            document.getElementById('textInput').value = "";
            document.getElementById('imagePasskey').textContent = "";
            document.getElementById('textPasskey').textContent = "";
            document.getElementById('imageKeyInput').value = "";
            document.getElementById('textKeyInput').value = "";
            document.getElementById('imageError').textContent = "";
            document.getElementById('textError').textContent = "";
            document.getElementById('decryptedImage').classList.add('hidden');
            document.getElementById('decryptedText').textContent = "";
        }

        // Simple XOR encryption function
        function xorEncrypt(data, key) {
            return data.split('').map((char, index) => {
                const keyChar = key.charCodeAt(index % key.length);
                return String.fromCharCode(char.charCodeAt(0) ^ keyChar);
            }).join('');
        }

        // Base64 encode after encryption
        function encryptData(data, passkey) {
            const encrypted = xorEncrypt(data, passkey);
            return btoa(encrypted);
        }

        // Base64 decode before decryption
        function decryptData(encryptedData, passkey) {
            const decoded = atob(encryptedData);
            return xorEncrypt(decoded, passkey);
        }

        // Generate Unique Passkey
        function generatePasskey() {
            return Math.random().toString(36).slice(2, 10).toUpperCase();
        }

        // Save to Local Storage
        function saveToLocalStorage(passkey, data) {
            const encryptedItems = JSON.parse(localStorage.getItem('encryptedItems')) || {};
            encryptedItems[passkey] = data;
            localStorage.setItem('encryptedItems', JSON.stringify(encryptedItems));
        }

        // Get from Local Storage
        function getFromLocalStorage(passkey) {
            const encryptedItems = JSON.parse(localStorage.getItem('encryptedItems')) || {};
            return encryptedItems[passkey];
        }

        // Remove from Local Storage
        function removeFromLocalStorage(passkey) {
            const encryptedItems = JSON.parse(localStorage.getItem('encryptedItems')) || {};
            delete encryptedItems[passkey];
            localStorage.setItem('encryptedItems', JSON.stringify(encryptedItems));
        }

        // Encrypt Image
        function encryptImage() {
            let file = document.getElementById('imageInput').files[0];
            if (!file) {
                showPopupMessage("❌ No image selected!");
                return;
            }

            let passkey = generatePasskey();
            let reader = new FileReader();

            reader.onload = function(event) {
                // Get the Base64 data without the prefix
                const base64Data = event.target.result.split(',')[1];
                
                // Encrypt the data
                const encryptedData = encryptData(base64Data, passkey);
                
                // Create a data URL for the encrypted image
                const encryptedImageUrl = `data:image/png;base64,${encryptedData}`;
                
                // Save to storage
                const encryptedItem = { 
                    type: 'image', 
                    data: encryptedImageUrl,
                    originalData: event.target.result, // Store original for decryption
                    timestamp: new Date().toISOString()
                };
                
                saveToLocalStorage(passkey, encryptedItem);
                
                // Show passkey and encrypted image preview
                document.getElementById('imagePasskey').innerHTML = `
                    <span class="green-text">Passkey: ${passkey}</span>
                    <br>
                    <button class="futuristic-button small" onclick="downloadPasskey('${passkey}')">Download Passkey</button>
                    <div class="image-preview">
                        <h3>Encrypted Image Preview:</h3>
                        <img src="${encryptedImageUrl}" style="max-width: 200px; border: 1px solid red;">
                        <p class="note">Note: This is what the encrypted image looks like</p>
                    </div>
                `;
                
                showPopupMessage("✅ Image Encrypted and Saved!");
            };

            reader.readAsDataURL(file);
        }

        // Encrypt Text
        function encryptText() {
            let text = document.getElementById('textInput').value;
            if (!text) {
                showPopupMessage("❌ No text entered!");
                return;
            }

            let passkey = generatePasskey();
            const encryptedItem = { 
                type: 'text', 
                data: text,
                timestamp: new Date().toISOString()
            };
            saveToLocalStorage(passkey, encryptedItem);

            document.getElementById('textPasskey').innerHTML = `
                <span class="green-text">Passkey: ${passkey}</span>
                <br>
                <button class="futuristic-button small" onclick="downloadPasskey('${passkey}')">Download Passkey</button>
            `;
            showPopupMessage("✅ Text Encrypted and Saved!");
        }

        // Decrypt Image
        function decryptImage() {
            let passkey = document.getElementById('imageKeyInput').value.trim();
            const encryptedItem = getFromLocalStorage(passkey);

            if (encryptedItem && encryptedItem.type === 'image') {
                try {
                    // Get the encrypted Base64 data without the prefix
                    const encryptedData = encryptedItem.data.split(',')[1];
                    
                    // Decrypt the data
                    const decryptedData = decryptData(encryptedData, passkey);
                    
                    // Create a data URL for the decrypted image
                    const decryptedImageUrl = `data:image/png;base64,${decryptedData}`;
                    
                    document.getElementById('decryptedImage').src = decryptedImageUrl;
                    document.getElementById('decryptedImage').classList.remove('hidden');
                    document.getElementById('imageError').textContent = "";

                    removeFromLocalStorage(passkey);
                    showPopupMessage("✅ Image Decrypted!");
                } catch (e) {
                    document.getElementById('imageError').textContent = "❌ Failed to decrypt - wrong passkey?";
                    document.getElementById('decryptedImage').classList.add('hidden');
                }
            } else {
                document.getElementById('imageError').textContent = "❌ Wrong Passkey or Data Not Found!";
                document.getElementById('decryptedImage').classList.add('hidden');
            }
        }

        // Decrypt Text
        function decryptText() {
            let passkey = document.getElementById('textKeyInput').value.trim();
            const encryptedItem = getFromLocalStorage(passkey);

            if (encryptedItem && encryptedItem.type === 'text') {
                document.getElementById('decryptedText').textContent = encryptedItem.data;
                document.getElementById('textError').textContent = "";

                removeFromLocalStorage(passkey);
                showPopupMessage("✅ Text Decrypted!");
            } else {
                document.getElementById('textError').textContent = "❌ Wrong Passkey or Data Not Found!";
                document.getElementById('decryptedText').textContent = "";
            }
        }

        // Download Passkey as File
        function downloadPasskey(passkey) {
            const blob = new Blob([passkey], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `passkey-${passkey}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Show Popup Messages
        function showPopupMessage(message) {
            let popup = document.createElement("div");
            popup.className = "popup-message";
            popup.textContent = message;
            document.body.appendChild(popup);

            setTimeout(() => {
                popup.remove();
            }, 2000);
        }
    </script>
</body>
</html>
